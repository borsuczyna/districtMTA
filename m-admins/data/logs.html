<style>
    #admin-logs {
        --window-x: 1rem;
        --window-y: calc(50% - 9.5rem);
        --window-width: 30rem;
        --window-height: 17rem;
    }

    #admin-logs .window {
        background-color: rgba(27, 27, 27, 0.4);
        border-radius: 0.5rem;
        position: fixed;
        top: var(--window-y);
        left: var(--window-x);
        width: var(--window-width);
        height: var(--window-height);
        overflow: hidden;
        display: flex;
        flex-direction: column;
    }

    #admin-logs .top {
        background-color: rgba(27, 27, 27, 0.8);
        padding: 0.3rem;
        font-size: 0.7rem;
        text-align: center;
        color: rgba(255, 255, 255, 0.8);
    }

    #admin-logs .rows {
        padding: 0.6rem;
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 1);
        font-weight: 500;
        text-shadow: 0.0625rem 0.0625rem 0.125rem rgba(0, 0, 0, 0.6);
        overflow-y: auto;
        overflow-x: auto;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
        gap: 0.2rem;
    }

    #admin-logs .rows div {
        display: flex;
        gap: 0.2rem;
        justify-content: space-between;
        text-wrap: nowrap;
    }

    #admin-logs .rows::-webkit-scrollbar {
        width: 0.5rem;
        height: 0.5rem;
    }

    #admin-logs .rows::-webkit-scrollbar-thumb {
        background-color: rgba(255, 255, 255, 0.2);
        border-radius: 0.25rem;
    }

    #admin-logs .rows::-webkit-scrollbar-thumb:hover {
        background-color: rgba(255, 255, 255, 0.3);
    }

    #admin-logs .rows::-webkit-scrollbar-track {
        background-color: rgba(27, 27, 27, 0.4);
    }

    #admin-logs .rows::-webkit-scrollbar-corner {
        background-color: rgba(27, 27, 27, 0.4);
    }

    #admin-logs .categories {
        display: flex;
        justify-content: space-around;
        font-size: 0.7rem;
        gap: 0.1rem;
        color: rgba(255, 255, 255, 0.8);
    }

    #admin-logs .category {
        background-color: rgba(27, 27, 27, 0.45);
        color: rgba(255, 255, 255, 0.9);
        flex: 1;
        padding: 0.3rem;
        text-align: center;
    }

    #admin-logs .category:hover {
        background-color: rgba(27, 27, 27, 0.7);
    }

    #admin-logs .category.active {
        background-color: rgba(27, 27, 27, 0.8);
    }
</style>

<div class="window" id="admin-logs">
    <div class="top">Logi serwerowe</div>
    <div class="rows"></div>
    <div class="categories">
        <div class="category active" onclick="adminLogs_setCategory(this)" data-category="wszystko">Wszystko</div>
        <div class="category" onclick="adminLogs_setCategory(this)" data-category="chat">Chat</div>
        <div class="category" onclick="adminLogs_setCategory(this)" data-category="przelewy">Przelewy</div>
        <div class="category" onclick="adminLogs_setCategory(this)" data-category="pm">PM</div>
    </div>
</div>

<script>
    let iconsList = {
        'trash': `<svg style="width: 1.2rem !important; height: 1.2rem !important;" viewBox="0 0 24 24" version="1.1">
            <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                <rect x="0" y="0" width="24" height="24"/>
                <path d="M6,8 L18,8 L17.106535,19.6150447 C17.04642,20.3965405 16.3947578,21 15.6109533,21 L8.38904671,21 C7.60524225,21 6.95358004,20.3965405 6.89346498,19.6150447 L6,8 Z M8,10 L8.45438229,14.0894406 L15.5517885,14.0339036 L16,10 L8,10 Z" fill="currentColor" fill-rule="nonzero"/>
                <path d="M14,4.5 L14,3.5 C14,3.22385763 13.7761424,3 13.5,3 L10.5,3 C10.2238576,3 10,3.22385763 10,3.5 L10,4.5 L5.5,4.5 C5.22385763,4.5 5,4.72385763 5,5 L5,5.5 C5,5.77614237 5.22385763,6 5.5,6 L18.5,6 C18.7761424,6 19,5.77614237 19,5.5 L19,5 C19,4.72385763 18.7761424,4.5 18.5,4.5 L14,4.5 Z" fill="currentColor" opacity="0.3"/>
            </g>
        </svg>`
    }

    window.adminLogs_addLog = (category, text, icons) => {
        let rows = document.querySelector('#admin-logs .rows');
        const atBottom = rows.scrollHeight - rows.scrollTop >= rows.clientHeight - 1;

        const row = document.createElement('div');
        const span = document.createElement('span');
        const iconsDom = document.createElement('span');
        span.innerHTML = applyHexColor(text);

        if (icons) {
            icons.forEach((icon) => {
                let iconDom = document.createElement('span');
                iconDom.innerHTML = iconsList[icon[0]];
                iconDom.classList.add('icon');
                iconDom.onclick = () => {
                    mta.triggerEvent('logs:iconClick', ...icon.slice(1));
                }
                iconsDom.appendChild(iconDom);
            });
        }

        row.appendChild(span);
        row.appendChild(iconsDom);
        row.dataset.category = category;

        rows.appendChild(row);

        if (atBottom) {
            rows.scrollTop = rows.scrollHeight;
        }
    }

    window.adminLogs_setCategory = (category) => {
        document.querySelectorAll('#admin-logs .category').forEach((el) => {
            el.classList.remove('active');
        });
        category.classList.add('active');

        document.querySelectorAll('#admin-logs .rows div').forEach((el) => {
            if (category.dataset.category === 'wszystko' || el.dataset.category === category.dataset.category) {
                el.style.display = 'block';
            } else {
                el.style.display = 'none';
            }
        });

        document.querySelector('#admin-logs .rows').scrollTop = document.querySelector('#admin-logs .rows').scrollHeight;
    }

    addEvent('admin-logs', 'mousedown', (e) => {
        if (e?.target?.classList.contains('top') && e?.target?.closest('#admin-logs')) {
            let dom = e.target.parentElement.getBoundingClientRect();
            e.target.parentElement.dataset.dragging = true;
            e.target.parentElement.dataset.draggingX = e.clientX - dom.x;
            e.target.parentElement.dataset.draggingY = e.clientY - dom.y;
        }
    });

    addEvent('admin-logs', 'mouseup', (e) => {
        if (e?.target?.classList.contains('top') && e?.target?.closest('#admin-logs')) {
            e.target.parentElement.dataset.dragging = false;
        }
    });

    addEvent('admin-logs', 'mousemove', (e) => {
        let window = document.querySelector('#admin-logs .window');
        if (window.dataset.dragging === 'true') {
            window.style.left = e.clientX - window.dataset.draggingX + 'px';
            window.style.top = e.clientY - window.dataset.draggingY + 'px';
        }
    });

    addEvent('admin-logs', 'interface:data:addLog', async (data) => {
        data = data[0];
        adminLogs_addLog(data.category, data.message, data.icons);
    });

    adminLogs_addLog('wszystko', 'Załadowano logi serwerowe');
    // adminLogs_addLog('czat', 'Załadowano logi serwerowe', [
    //     ['trash', 'delete']
    // ]);
    // adminLogs_addLog('czat', 'Załadowano logi serwerowe', [
    //     ['trash', 'delete']
    // ]);
    // adminLogs_addLog('czat', 'Załadowano logi serwerowe', [
    //     ['trash', 'delete']
    // ]);
    // adminLogs_addLog('czat', 'Załadowano logi serwerowe', [
    //     ['trash', 'delete']
    // ]);
    // adminLogs_addLog('czat', 'Załadowano logi serwerowe', [
    //     ['trash', 'delete'],
    //     ['trash', 'delete', 'test'],
    //     ['trash', 'delete'],
    // ]);
</script>